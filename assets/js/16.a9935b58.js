(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{289:function(t,a,s){"use strict";s.r(a);var e=s(14),r=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"json-web-token"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#json-web-token"}},[t._v("#")]),t._v(" JSON WEB TOKEN")]),t._v(" "),a("p",[a("code",[t._v("JSON WEB TOKEN")]),t._v("简称为"),a("code",[t._v("JWT")]),t._v("，是一个基于"),a("code",[t._v("JSON")]),t._v("的开放标准，用于通信双方之间传递安全信息的简洁的、"),a("code",[t._v("URL")]),t._v("安全的表述性声明规范，经常用于身份验证。")]),t._v(" "),a("h2",{attrs:{id:"结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#结构"}},[t._v("#")]),t._v(" 结构")]),t._v(" "),a("p",[a("code",[t._v("JWT")]),t._v("有三部分组成，他们之间用"),a("code",[t._v(".")]),t._v("分隔，这三部分分别是"),a("code",[t._v("Header")]),t._v("、"),a("code",[t._v("Payload")]),t._v("、"),a("code",[t._v("Signature")]),t._v("，结构如下：")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("Header"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Payload"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Signature\n")])])]),a("p",[t._v("在"),a("code",[t._v("jwt.io")]),t._v("给予的实例")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c\n")])])]),a("p",[t._v("对于这个例子，其三部分组成分别为")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// header")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"alg"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"HS256"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"typ"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"JWT"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Payload")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"sub"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1234567890"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"John Doe"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"iat"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1516239022")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Signature")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HMACSHA256")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("base64UrlEncode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("header"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"."')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("base64UrlEncode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("payload"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"your-256-bit-secret"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h3",{attrs:{id:"header"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#header"}},[t._v("#")]),t._v(" Header")]),t._v(" "),a("p",[a("code",[t._v("Header")]),t._v("头部，其由两部分组成：声明类型和算法名称，在本例中的"),a("code",[t._v("Token")]),t._v("类型为"),a("code",[t._v("jwt")]),t._v("，加密算法为"),a("code",[t._v("HMAC-SHA256")]),t._v("。将"),a("code",[t._v("Header")]),t._v("进行"),a("code",[t._v("BASE64URL")]),t._v("算法编码，即可得到"),a("code",[t._v("jwt")]),t._v("的第一部分，注意"),a("code",[t._v("BASE64URL")]),t._v("算法编码与"),a("code",[t._v("BASE64")]),t._v("编码略有不同，"),a("code",[t._v("BASE64URL")]),t._v("需要将"),a("code",[t._v("BASE64")]),t._v("中输出中的"),a("code",[t._v("+")]),t._v("替换为减号"),a("code",[t._v("-")]),t._v("，"),a("code",[t._v("/")]),t._v("替换为"),a("code",[t._v("_")]),t._v("，而且没有标准的"),a("code",[t._v("BASE64")]),t._v("填充，把"),a("code",[t._v("=")]),t._v("去掉。")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("base64UrlEncode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"alg"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"HS256"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"typ"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"JWT"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h3",{attrs:{id:"payload"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#payload"}},[t._v("#")]),t._v(" Payload")]),t._v(" "),a("p",[a("code",[t._v("Payload")]),t._v("有效载荷，其为"),a("code",[t._v("JWT")]),t._v("的主体，这里可以存放主体数据信息，"),a("code",[t._v("Payload")]),t._v("包含三个部分，标准中注册的声明、公共的声明、私有的声明。")]),t._v(" "),a("h4",{attrs:{id:"标准中注册的声明-建议但不强制使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#标准中注册的声明-建议但不强制使用"}},[t._v("#")]),t._v(" 标准中注册的声明 （建议但不强制使用）")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("iss")]),t._v(": "),a("code",[t._v("jwt")]),t._v("签发者。")]),t._v(" "),a("li",[a("code",[t._v("sub")]),t._v(": "),a("code",[t._v("jwt")]),t._v("主题。")]),t._v(" "),a("li",[a("code",[t._v("aud")]),t._v(": "),a("code",[t._v("jwt")]),t._v("接收者。")]),t._v(" "),a("li",[a("code",[t._v("exp")]),t._v(": "),a("code",[t._v("jwt")]),t._v("过期时间。")]),t._v(" "),a("li",[a("code",[t._v("nbf")]),t._v(": "),a("code",[t._v("jwt")]),t._v("生效时间。")]),t._v(" "),a("li",[a("code",[t._v("iat")]),t._v(": "),a("code",[t._v("jwt")]),t._v("的签发时间。")]),t._v(" "),a("li",[a("code",[t._v("jti")]),t._v(": "),a("code",[t._v("jwt")]),t._v("的唯一身份标识，避免重放攻击。")])]),t._v(" "),a("h4",{attrs:{id:"公共声明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#公共声明"}},[t._v("#")]),t._v(" 公共声明")]),t._v(" "),a("p",[t._v("可以在公共声明添加任何信息，我们一般会在里面添加用户信息和业务信息，但是不建议添加敏感信息，因为公共声明部分可以在客户端解密，除非此信息是加密的。")]),t._v(" "),a("h4",{attrs:{id:"私有声明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#私有声明"}},[t._v("#")]),t._v(" 私有声明")]),t._v(" "),a("p",[t._v("私有声明是服务器和客户端共同定义的声明，同样这里不建议添加敏感信息。")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("base64UrlEncode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"sub"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1234567890"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"John Doe"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"iat"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1516239022")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h3",{attrs:{id:"signature"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#signature"}},[t._v("#")]),t._v(" Signature")]),t._v(" "),a("p",[a("code",[t._v("Signature")]),t._v("哈希签名，其通过"),a("code",[t._v("JWT")]),t._v("中"),a("code",[t._v("Header")]),t._v("定义的算法，将前两部分数据进行编码后哈希来生成签名，主要是确保数据不会被篡改。")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HMACSHA256")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("base64UrlEncode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("header"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"."')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("base64UrlEncode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("payload"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"your-256-bit-secret"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c"')]),t._v("\n")])])]),a("h2",{attrs:{id:"优点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#优点"}},[t._v("#")]),t._v(" 优点")]),t._v(" "),a("ul",[a("li",[t._v("无状态和可拓展性，服务器将"),a("code",[t._v("JWT")]),t._v("存储到客户端以后不存在状态或者会话信息，易于拓展。")]),t._v(" "),a("li",[t._v("可以预防"),a("code",[t._v("CSRF")]),t._v("攻击，由于使用"),a("code",[t._v("JWT")]),t._v("一般放置于请求头的"),a("code",[t._v("Authorization: Bearer ${JWT}")]),t._v("字段中而不使用"),a("code",[t._v("Cookie")]),t._v("可以有效防止"),a("code",[t._v("CSRF")]),t._v("攻击。")]),t._v(" "),a("li",[a("code",[t._v("payload")]),t._v("部分可以存储一些其他业务逻辑所必要的非敏感信息，可以减轻服务端压力。")]),t._v(" "),a("li",[a("code",[t._v("JWT")]),t._v("的跨语言支持性，由于"),a("code",[t._v("json")]),t._v("与加密算法的通用性，在多数语言中都能得到支持。")]),t._v(" "),a("li",[t._v("相对于"),a("code",[t._v("OAuth2")]),t._v("更加轻量，但是其应用场景有所区别，"),a("code",[t._v("OAuth2")]),t._v("是一种授权框架，通常用于第三方应用授权，"),a("code",[t._v("JWT")]),t._v("是一种认证协议，用于前后端分离的用户认证以及后端"),a("code",[t._v("API")]),t._v("的保护。")])]),t._v(" "),a("h2",{attrs:{id:"缺点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#缺点"}},[t._v("#")]),t._v(" 缺点")]),t._v(" "),a("ul",[a("li",[t._v("一旦签发无法更新，如果想更新数据或者续签，必须重新签发。")]),t._v(" "),a("li",[t._v("无法废弃，在"),a("code",[t._v("JWT")]),t._v("设置的过期时间到达之前，"),a("code",[t._v("JWT")]),t._v("始终有效。")]),t._v(" "),a("li",[a("code",[t._v("Payload")]),t._v("是使用"),a("code",[t._v("BASE64URL")]),t._v("编码的，并没有加密，因此"),a("code",[t._v("jwt")]),t._v("中在未加密的情况下不能存储敏感数据。")]),t._v(" "),a("li",[a("code",[t._v("JWT")]),t._v("本身包含认证信息，因此一旦信息泄露，任何人都可以获得令牌的所有权限，所以"),a("code",[t._v("JWT")]),t._v("的有效期不宜设置太长。")]),t._v(" "),a("li",[t._v("伪造"),a("code",[t._v("JWT")]),t._v("，攻击者拥有一个"),a("code",[t._v("JWT")]),t._v("，可以伪造"),a("code",[t._v("Header")]),t._v("中的"),a("code",[t._v("alg")]),t._v("为"),a("code",[t._v("none")]),t._v("来验证身份，理论上这是符合"),a("code",[t._v("JWT")]),t._v("规范要求的，而且有些库中都默认实现此验证，所以需要禁用"),a("code",[t._v("alg")]),t._v("为"),a("code",[t._v("none")]),t._v("的请求。")]),t._v(" "),a("li",[t._v("爆破"),a("code",[t._v("HMAC")]),t._v("密钥，由于用户可以拿到完整的"),a("code",[t._v("JWT")]),t._v("，其中就包含加密算法，用户可以根据"),a("code",[t._v("JWT")]),t._v("中信息爆破密钥，而且整个操作可以本地完成，不需要与服务端交互。")])]),t._v(" "),a("h2",{attrs:{id:"相关"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#相关"}},[t._v("#")]),t._v(" 相关")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("CSRF https://github.com/WindrunnerMax/EveryDay/blob/master/Browser/CSRF%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0.md\nXSS https://github.com/WindrunnerMax/EveryDay/blob/master/Browser/XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB.md\nCookie与Session https://github.com/WindrunnerMax/EveryDay/blob/master/HTML/Cookie%E4%B8%8ESession.md\n")])])]),a("h2",{attrs:{id:"每日一题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#每日一题"}},[t._v("#")]),t._v(" 每日一题")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("https://github.com/WindrunnerMax/EveryDay\n")])])]),a("h2",{attrs:{id:"参考"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[t._v("#")]),t._v(" 参考")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("https://www.freebuf.com/vuls/219056.html\nhttps://blog.csdn.net/qq_28165595/article/details/80214994\n")])])])])}),[],!1,null,null,null);a.default=r.exports}}]);